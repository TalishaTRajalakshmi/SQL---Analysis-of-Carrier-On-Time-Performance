--Rank airlines by year: what are the airlines with the most flights by year? Any trends worth noting?SELECT     Year,     Marketing_Airline_Network,     COUNT(*) AS Total_Number_Of_FlightsFROM     "AwsDataCatalog"."flights"."flights_talisha"GROUP BY     Year,     Marketing_Airline_NetworkORDER BY     Year,     Total_Number_Of_Flights DESC;--When is the best time of day/day of week/time of year to fly to minimise delays?SELECT     -- Extract hour from CRSDepTime by converting to a 4-character string with leading zeros if necessary, then taking the first 2 characters as hour    CAST(SUBSTR(LPAD(CAST(CRSDepTime AS VARCHAR), 4, '0'), 1, 2) AS INTEGER) AS Departure_Hour,    DayOfWeek,    -- Parse FlightDate assuming it's in the format 'M/d/yy'    EXTRACT(MONTH FROM DATE_PARSE(FlightDate, '%c/%e/%y')) AS Month,    AVG(CASE WHEN DepDelayMinutes > 0 THEN DepDelayMinutes ELSE 0 END) AS Average_Departure_Delay,    AVG(CASE WHEN ArrDelayMinutes > 0 THEN ArrDelayMinutes ELSE 0 END) AS Average_Arrival_Delay,    SUM(Cancelled) AS Total_Cancellations,    SUM(Diverted) AS Total_Diversions,    COUNT(*) AS Total_FlightsFROM     "AwsDataCatalog"."flights"."flights_talisha"GROUP BY     CAST(SUBSTR(LPAD(CAST(CRSDepTime AS VARCHAR), 4, '0'), 1, 2) AS INTEGER),    DayOfWeek,    EXTRACT(MONTH FROM DATE_PARSE(FlightDate, '%c/%e/%y'))ORDER BY     Average_Departure_Delay ASC,    Average_Arrival_Delay ASC,    Total_Cancellations ASC,    Total_Diversions ASC;--How does the number of people flying between different locations change over time?SELECT    Origin,    Dest,    COUNT(*) AS Total_FlightsFROM     "AwsDataCatalog"."flights"."flights_talisha"GROUP BY     Origin,    DestORDER BY     Total_Flights DESC;--What percentage of flights delayed by weather per airport?WITH WeatherDelays AS (    SELECT        Origin,        COUNT(*) AS TotalFlights,        COUNT(CASE WHEN WeatherDelay > 0 THEN 1 END) AS WeatherDelayFlights    FROM        "AwsDataCatalog"."flights"."flights_talisha"    GROUP BY        Origin)SELECT    Origin,    TotalFlights,    WeatherDelayFlights,    ROUND((WeatherDelayFlights * 100.0) / TotalFlights, 2) AS WeatherDelayPercentageFROM    WeatherDelaysWHERE    TotalFlights > 0ORDER BY    WeatherDelayPercentage DESC;--How well does weather predict plane delays?WITH WeatherDelays AS (    SELECT        Origin,        COUNT(*) AS TotalFlights,        SUM(CASE WHEN WeatherDelay > 0 THEN 1 ELSE 0 END) AS WeatherDelayFlights,        AVG(CASE WHEN WeatherDelay > 0 THEN WeatherDelay ELSE NULL END) AS AvgWeatherDelay,        AVG(DepDelay) AS AvgDepartureDelay,        AVG(ArrDelay) AS AvgArrivalDelay    FROM        "AwsDataCatalog"."flights"."flights_talisha"    GROUP BY        Origin)SELECT    Origin,    TotalFlights,    WeatherDelayFlights,    ROUND((WeatherDelayFlights * 100.0) / TotalFlights, 2) AS WeatherDelayPercentage,    ROUND(AvgWeatherDelay, 2) AS AvgWeatherDelay,    ROUND(AvgDepartureDelay, 2) AS AvgDepartureDelay,    ROUND(AvgArrivalDelay, 2) AS AvgArrivalDelayFROM    WeatherDelaysWHERE    TotalFlights > 0ORDER BY    WeatherDelayPercentage DESC;--extra workWITH RankedFlights AS (    SELECT        Origin,        Dest,        DayOfMonth,        COUNT(*) AS TotalFlights,        RANK() OVER (PARTITION BY Origin, Dest ORDER BY COUNT(*) DESC) AS Rank    FROM        "AwsDataCatalog"."flights"."flights_talisha"    GROUP BY        Origin,        Dest,        DayOfMonth)SELECT    Origin,    Dest,    DayOfMonth,    TotalFlightsFROM    RankedFlightsWHERE    Rank = 1ORDER BY    TotalFlights DESC,    Origin,    Dest;